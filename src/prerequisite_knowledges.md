# 抑えておくべき概念


## テーブル・項目・属性

- テーブル(Tables)
    - データのコレクション
    - RDBのテーブルと同様
- 項目(Items)
    - 一意に識別可能な属性のグループ
    - RDBの行・レコードに対応
- 属性(Attributes)
    - データ要素
    - RDBの列・フィールドに対応

## キー

- パーティションキー
    - 必ず必要
    - ハッシュ関数への入力として使用される
    - 物理的に**項目が保存されるパーティション**が決まる
- ソートキー
    - 指定しなくても良い
    - パーティションキーと合わせて複合主キーとなる必要がある
    - 同じパーティションキーの項目はソートキーでソートされて保存される

**パーティションキーとソートキーで一意**になる必要があります。

→ RDBのように3列以上での複合主キーは設定できません。

## インデックスについて

非常に重要な概念です。

Query, Scan オペレーションのために使用します。

- GSI(グローバルセカンダリインデックス)
    - インデックスのプライマリキーを任意に指定可能
    - 一意にならなくてもよい
    - **キャパシティユニットを消費**する
    - テーブル作成後に追加可能
- LSI(ローカルセカンダリインデックス)
    - テーブルのパーティションキーを使用
    - ソートキーは任意に指定可能
    - **テーブル作成時**に指定する（テーブル作成後はLSIを追加できない）

## キャパシティユニット

書き込み・読み込みリクエストに対して**キャパシティユニット**という概念があり、

消費したキャパシティユニットに応じた料金が請求されます。

[DynamoDB のプロビジョンされた容量テーブルの設定の管理](https://docs.aws.amazon.com/ja_jp/amazondynamodb/latest/developerguide/ProvisionedThroughput.html)

- RCU
    - 1 RCU - 最大サイズ 4 KB の項目について、1 秒あたり 1 回の強力な整合性のある読み込み、あるいは 1 秒あたり 2 回の結果整合性のある読み込み
- WCU
    - 1 WCU - 最大サイズが 1 KB の項目について、1 秒あたり 1 回の書き込み
    - トランザクション書き込みリクエストでは2倍消費
